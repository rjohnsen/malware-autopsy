from argparse import ArgumentParser
from engines.yara import YaraEngine

def run():
	parser = ArgumentParser(
			prog="malware-autopsy.py",
			description="Malware Autopsy Tool"
		)

	parser.add_argument(
		"-f",
		"--file",
		help="Path to file to dissect",
		required=True
	)

	args = parser.parse_args()

	# Identity file format
	ye = YaraEngine(
		args.file
	)

	ye.run("yara/filetypes.yar")

	# Scan PDF content
	ye.run("yara/pdf_content.yar")

if __name__ == "__main__":
	run()
