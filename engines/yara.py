from engines.engine import Engine

import yara
import pprint

class YaraEngine(Engine):
	def __init__(self, file_path):
		super().__init__()
		self.name = "Yara Engine"
		self.description = "Engine to run Yara rules"
		self.file_path = file_path

	def run(self, yara_rule_path):
		rules = yara.compile(yara_rule_path)
		matches = rules.match(self.file_path)

		pprint.pprint(matches)